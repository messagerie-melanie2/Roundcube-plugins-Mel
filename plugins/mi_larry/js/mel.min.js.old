"addressbook"==rcmail.env.task&&$(document).on("keyup","input#quicksearchbox",function(e){var a;a="plugin.annuaire"==rcmail.env.action?$("#annuaire-list li.object"):$("#contacts-table tr.contact");var l=$(this).val().toLowerCase();a.show(),a.each(function(){var e,a=(e="plugin.annuaire"==rcmail.env.action?$(this).find("> span.name"):$(this).find("> td.name")).text().replace(/(<([^>]+)>)/gi,"");1<l.length?0<=a.toLowerCase().indexOf(l)?e.html(a.replace(new RegExp(l,"gi"),"<strong>$&</strong>")):(e.html(a),$(this).hide()):e.html(a)})}),window.rcmail&&rcmail.addEventListener("init",function(e){if("addressbook"==rcmail.env.task&&($("#directorylist-header").text(rcmail.get_label("mel_larry.allannuaires")),$('<li class="legend"><span>'+rcmail.get_label("mel_larry.personalannuaire")+"</span></li>").insertAfter("#directorylist li.all"),$("#savedsearchlist > li").length&&$("#savedsearchlist").prepend('<li class="legend"><span>'+rcmail.get_label("mel_larry.personalsearchs")+"</span></li>"),rcmail.addEventListener("abook_search_insert",function(e){$("#savedsearchlist > li.legend").length||$("#savedsearchlist").prepend('<li class="legend"><span>'+rcmail.get_label("mel_larry.personalsearchs")+"</span></li>")})),"addressbook"==rcmail.env.task&&"plugin.annuaire"==rcmail.env.action)$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in")+" "+$("#directorylist li.addressbook.selected > a").text());else if("calendar"==rcmail.env.task)$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in_calendars"));else if("tasks"==rcmail.env.task)$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in_tasks"));else if("settings"!=rcmail.env.task||rcmail.env.courrielleur){if("mail"==rcmail.env.task)if(""==rcmail.env.action||"show"==rcmail.env.action){var a={calendar:"#messagetoolbar > a.calendarlink",bounce:"#messagetoolbar > a.bounce",mel_labels_sync:"#messagetoolbar > a.thunderbird",managesieve:"#messagetoolbar > a.filterlink"};for(var l in a)-1!==rcmail.env.plugins.indexOf(l)&&$(a[l]).css("display","inline-block");""==rcmail.env.action&&-1!==rcmail.env.plugins.indexOf("mel_archivage")&&$("#messagetoolbar > a.archiver").css("display","inline-block"),-1!==rcmail.env.plugins.indexOf("mel_junk")?$("#messagetoolbar > span.junk").css("display","inline-block"):-1!==rcmail.env.plugins.indexOf("markasjunk")&&$("#messagetoolbar > a.junk").css("display","inline-block"),"show"==rcmail.env.action&&("light"==localStorage.getItem("message.theme")&&($("#messagecontent .switch.theme input").prop("checked",!0),$("#mainscreen").addClass("light")),$("#messagecontent .switch.theme input").change(function(){$("#mainscreen").toggleClass("light"),localStorage.setItem("message.theme",this.checked?"light":"dark")}))}else"preview"==rcmail.env.action?(-1!==rcmail.env.plugins.indexOf("calendar")&&$("#countcontrols > a.calendarlink").css("display","inline-block"),"light"==localStorage.getItem("message.theme")&&($("#messagepreview .switch.theme input").prop("checked",!0),$("body.iframe").addClass("light")),$("#messagepreview .switch.theme input").change(function(){$("body.iframe").toggleClass("light"),localStorage.setItem("message.theme",this.checked?"light":"dark")})):"compose"==rcmail.env.action&&$(rcmail.gui_objects.filedrop).get(0).addEventListener("drop",function(e){$("#compose-attachments").removeClass("hide")},!1)}else{var s=$("<div>");s.attr("class","disconnect");var t=$("<a>");t.attr("href","./?_task=logout"),t.attr("onclick","return rcmail.command('switch-task','logout',this,event)"),t.text(rcmail.get_label("mel.logout")),s.append(t),$("#settings-sections").append(s)}}),rcmail.addEventListener("actionafter",function(e){var a;"set-listmode"==e.action&&("threads"==e.props?$("#messagelist").addClass("threaded"):$("#messagelist").removeClass("threaded")),"list"==e.action&&("mail"==rcmail.env.task?($("#searchmenu-menu #s_scope_all").is(":checked")?$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in_all_folders")):$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in")+" "+$("#folderlist-content #mailboxlist li.mailbox.selected > a").clone().children().remove().end().text()),rcmail.env.threading?$("#messagelist").addClass("threaded"):$("#messagelist").removeClass("threaded")):"addressbook"==rcmail.env.task&&(rcmail.set_searchscope("list"),a=$("#directorylist li.addressbook.selected > a").clone().children().remove().end().text(),$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in")+" "+a)))}),rcmail.addEventListener("responseaftersearch",function(e){if("addressbook"==rcmail.env.task&&(""==e.response.env.source||!e.response.env.source)){var a=new Object;$("#contacts-table tr").each(function(){var e=$(this).attr("id").split(/-(.+)/)[1];e&&!a[e]&&(a[e]=$(this).attr("id"))});var l=!0;for(var s in a){var t=rcmail.get_label("mel_larry.foundin")+" "+$("#directorylist li#rcmli"+rcmail.html_identifier_encode(s)+" > a").clone().children().remove().end().text();l||$('<tr class="space"><td>&nbsp;</td></tr>').insertBefore("tr#"+a[s]),$('<tr class="legend"><td>'+t+"</td></tr>").insertBefore("tr#"+a[s]),l=!1}}});